---
bookCollapseSection: true
weight: 86
---

# 8.6.微服务
## 隔离
隔离，本质上是对系统或资源进行分割，从而实现当系统发生故障时能限定传播范围和影响范围，即发生故障后只有出问题的服务不可用，保证其他服务仍然可用。
* 服务隔离
    * 动静分离
        {{< img src="/architect/go/8.6/1.png" title="" >}}
        小到 CPU 的 cacheline false sharing、数据库 mysql 表设计中避免 bufferpool 频繁过期，隔离动静表，大到架构设计中的图片、静态资源等缓存加速。本质上都体现的一样的思路，即加速/缓存访问变换频次小的。比如 CDN 场景中，将静态资源和动态 API 分离，也是体现了隔离的思路:
            
            * 降低应用服务器负载，静态文件访问负载全部通过CDN。
            * 对象存储存储费用最低。
            * 海量存储空间，无需考虑存储架构升级。
            * 静态CDN带宽加速，延迟低
            
        {{< img src="/architect/go/8.6/2.png" title="" >}}
        archive: 稿件表，存储稿件的名称、作者、分类、tag、状态等信息，表示稿件的基本信息。
        
        **在一个投稿流程中，一旦稿件创建改动的频率比较低。**
        
        archive_stat: 稿件统计表，表示稿件的播放、点赞、收藏、投币数量，比较高频的更新。
        
        **随着稿件获取流量，稿件被用户所消费，各类计数信息更新比较频繁。
        MySQL BufferPool 是用于缓存 DataPage 的，DataPage 可以理解为缓存了表的行，那么如果频繁更新 DataPage 不断会置换，会导致命中率下降的问题，所以我们在表设计中，仍然可以沿用类似的思路，其主表基本更新，在上游 Cache 未命中，透穿到 MySQL，仍然有 BufferPool 的缓存。**
    * 读写分离: 主从、Replicaset、CQRS
  
* 轻重隔离
核心、快慢、热点
    * 核心隔离
        {{< img src="/architect/go/8.6/3.png" title="" >}}
 ```$xslt
    业务按照 Level 进行资源池划分(L0/L1/L2)。
    * 核心/非核心的故障域的差异隔离(机器资源、依赖资源)。
    * 多集群，通过冗余资源来提升吞吐和容灾能力。
```

* 物理隔离
线程、进程、集群、机房

## 超时控制
## 过载保护
## 限流
## 降级
## 重试
## 负载均衡
## 最佳实践
## References